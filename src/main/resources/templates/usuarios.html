<!DOCTYPE html>
<html xmlns:th="http://www.thymeleaf.org" lang="es">
<head>
    <meta charset="UTF-8">
    <title>Lista de Usuarios</title>
    <link rel="icon" type="image/x-icon" href="https://res.cloudinary.com/dv0hzntey/image/upload/v1754238574/urrea_g4nc5s.ico">v
    <script src="https://cdn.tailwindcss.com"></script>
</head>
<body class="flex min-h-screen">
<div class="w-64 bg-white border-r border-gray-200 shadow-lg">
    <div class="p-4 text-xl font-bold border-b">
        <a th:href="@{/admin/dashboard}">
            <img src="/images/logo.png" alt="SmartShop" class="w-40" />
        </a>
    </div>
    <nav class="p-4 space-y-2">
        <a th:href="@{/admin/users}" class="block px-4 py-2 rounded hover:bg-gray-100 text-gray-700 font-bold">Usuarios</a>
        <a th:href="@{/admin/orders}" class="block px-4 py-2 rounded hover:bg-gray-100 text-gray-700">Pedidos</a>
        <a th:href="@{/admin/quotes}" class="block px-4 py-2 rounded hover:bg-gray-100 text-gray-700">Cotizaciones</a>
        <a th:href="@{/admin/products}" class="block px-4 py-2 rounded hover:bg-gray-100 text-gray-700">Productos</a>
        <a th:href="@{/admin/promotions}" class="block px-4 py-2 rounded hover:bg-gray-100 text-gray-700">Carousel</a>
        <a th:href="@{/admin/logout}" class="block px-4 py-2 rounded hover:bg-red-100 text-red-600">Cerrar sesión</a>
    </nav>
</div>
<div class="w-[90%] mx-auto bg-white p-6 rounded shadow">
    <h1 class="text-2xl font-bold mb-4 text-gray-700">Usuarios del sistema</h1>
    <div class="overflow-x-auto">
        <table class="min-w-full border divide-y divide-gray-200">
            <thead class="bg-gray-50">
            <tr>
                <th class="px-4 py-2 text-left text-xs font-medium text-gray-500 uppercase">ID</th>
                <th class="px-4 py-2 text-left text-xs font-medium text-gray-500 uppercase">Nombre</th>
                <th class="px-4 py-2 text-left text-xs font-medium text-gray-500 uppercase">Email</th>
                <th class="px-4 py-2 text-left text-xs font-medium text-gray-500 uppercase">Roles</th>
                <th class="px-4 py-2 text-center text-xs font-medium text-gray-500 uppercase">Acciones</th>
            </tr>
            </thead>
            <tbody class="bg-white divide-y divide-gray-100" th:if="${usuarios != null}">
            <tr th:each="usuario : ${usuarios}">
                <td class="px-4 py-2 text-sm text-gray-700" th:text="${usuario.id.substring(usuario.id.length()-7, usuario.id.length()-1)}">1</td>
                <td class="px-4 py-2 text-sm text-gray-700" th:text="${usuario.name}">Juan Pérez</td>
                <td class="px-4 py-2 text-sm text-gray-700" th:text="${usuario.email}">juan@example.com</td>
                <td class="px-4 py-2 text-sm text-gray-700 flex gap-0.5" th:if="${usuario.roles.size() == 0}"><div class="bg-blue-500 text-white text-xs p-1 text-center font-bold font-mono rounded-md">sin asignar</div></td>
                <td class="px-4 py-2 text-xs text-gray-700 flex flex-row gap-0.5"><div th:each="role: ${usuario.getRoles()}" class="bg-blue-500 text-white text-xs p-1 text-center font-bold font-mono rounded-md" th:text="${role.name.replace('ROLE_','').toLowerCase()}">sin asignar</div></td>
                <td class="px-4 py-2">
                    <div class="flex gap-1 justify-center">
                        <a th:href="@{'/admin/usuario/' + ${usuario.id}}" class="text-blue-600 hover:text-blue-800 text-sm font-medium flex items-center space-x-2">
                            <svg xmlns="http://www.w3.org/2000/svg" width="18" height="18" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round" class="text-blue-500">
                                <path d="M21 15v4a2 2 0 0 1-2 2H5a2 2 0 0 1-2-2v-4"/>
                                <polyline points="7 10 12 15 17 10"/>
                                <line x1="12" x2="12" y1="15" y2="3"/>
                            </svg>
                            <span>Ver</span>
                        </a>
                        <a th:href="@{'/admin/usuario/edit/' + ${usuario.id}}" class="text-green-600 hover:text-green-800 text-sm font-medium flex items-center space-x-2 ml-2">
                            <svg xmlns="http://www.w3.org/2000/svg" width="18" height="18" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round" class="text-green-500">
                                <path d="M12.22 2h-.44a2 2 0 0 0-2 2v.18a2 2 0 0 1-1 1.73l-.43.25a2 2 0 0 1-2 0l-.15-.08a2 2 0 0 0-2.73.73l-.78 1.28a2 2 0 0 0 .73 2.73l.15.08a2 2 0 0 1 1 1.74v.17a2 2 0 0 0 2 2h.44a2 2 0 0 0 2-2v-.18a2 2 0 0 1 1-1.73l.43-.25a2 2 0 0 1 2 0l.15.08a2 2 0 0 0 2.73-.73l.78-1.28a2 2 0 0 0-.73-2.73l-.15-.08a2 2 0 0 1-1-1.74V4a2 2 0 0 0-2-2Z"/>
                                <circle cx="12" cy="12" r="3"/>
                            </svg>
                            <span>Editar</span>
                        </a>
                    </div>
                </td>
            </tr>
            </tbody>
            <tbody th:if="${usuarios == null or #lists.isEmpty(usuarios)}">
            <tr>
                <td colspan="5" class="px-4 py-4 text-center text-gray-500">No hay usuarios registrados.</td>
            </tr>
            </tbody>
        </table>
    </div>
</div>
</body>
</html>
