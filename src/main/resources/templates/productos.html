<!DOCTYPE html>
<html xmlns:th="http://www.thymeleaf.org" lang="es">
<head>
    <meta charset="UTF-8">
    <title>Gestión de Productos</title>
    <link rel="icon" type="image/x-icon" href="https://res.cloudinary.com/dv0hzntey/image/upload/v1754238574/urrea_g4nc5s.ico">
    <script src="https://cdn.tailwindcss.com"></script>
</head>
<body class="flex min-h-screen bg-gray-50">

<div class="w-64 bg-white border-r border-gray-200 shadow-lg">
    <div class="p-4 text-xl font-bold border-b">
        <a th:href="@{/admin/dashboard}">
            <img th:src="@{/images/logo.png}" alt="SmartShop" class="w-40" />
        </a>
    </div>
    <nav class="p-4 space-y-2">
        <a th:href="@{/admin/users}" class="block px-4 py-2 rounded hover:bg-gray-100 text-gray-700">Usuarios</a>
        <a th:href="@{/admin/orders}" class="block px-4 py-2 rounded hover:bg-gray-100 text-gray-700">Pedidos</a>
        <a th:href="@{/admin/quotes}" class="block px-4 py-2 rounded hover:bg-gray-100 text-gray-700">Cotizaciones</a>
        <a th:href="@{/admin/products}" class="block px-4 py-2 rounded hover:bg-gray-100 text-gray-700 font-bold">Productos</a>
        <a th:href="@{/admin/promotions}" class="block px-4 py-2 rounded hover:bg-gray-100 text-gray-700">Carousel</a>
        <a th:href="@{/admin/logout}" class="block px-4 py-2 rounded hover:bg-red-100 text-red-600">Cerrar sesión</a>
    </nav>
</div>

<div class="w-[90%] mx-auto bg-white p-6 rounded shadow my-6">

    <form th:action="@{/admin/products}" method="get" class="mb-4">
        <div class="flex">
            <input type="text" name="query" class="w-full px-3 py-2 border border-gray-300 rounded-l-md focus:outline-none focus:ring-2 focus:ring-blue-500" placeholder="Buscar por nombre, SKU o categoría..." th:value="${param.query}">
            <button type="submit" class="bg-gray-700 text-white px-4 py-2 rounded-r-md hover:bg-gray-800">Buscar</button>
        </div>
    </form>

    <div class="overflow-x-auto">
        <table class="min-w-full border divide-y divide-gray-200">
            <thead class="bg-gray-50">
            <tr>
                <th class="px-4 py-2 text-left text-xs font-medium text-gray-500 uppercase">Imagen</th>
                <th class="px-4 py-2 text-left text-xs font-medium text-gray-500 uppercase">SKU</th>
                <th class="px-4 py-2 text-left text-xs font-medium text-gray-500 uppercase">Nombre</th>
                <th class="px-4 py-2 text-left text-xs font-medium text-gray-500 uppercase">Categoría</th>
                <th class="px-4 py-2 text-left text-xs font-medium text-gray-500 uppercase">Vendedor</th>
                <th class="px-4 py-2 text-left text-xs font-medium text-gray-500 uppercase text-center">Precio</th>
                <th class="px-4 py-2 text-center text-xs font-medium text-gray-500 uppercase">Acciones</th>
            </tr>
            </thead>
            <tbody class="bg-white divide-y divide-gray-100" th:if="${productPage != null and !productPage.empty}">
            <tr th:each="producto : ${productPage.content}">
                <td class="px-4 py-2">
                    <img th:src="${producto.imageUrl != null ? producto.imageUrl : '/images/placeholder.png'}" alt="Imagen del producto" class="w-12 h-12 object-cover rounded">
                </td>
                <td class="px-4 py-2 text-sm text-gray-600 font-mono" th:text="${producto.sku}">SKU12345</td>
                <td class="px-4 py-2 text-sm text-gray-800 font-semibold" th:text="${producto.name}">Producto Ejemplo</td>
                <td class="px-4 py-2 text-sm text-gray-600" th:text="${producto.category}">Categoría</td>
                <td class="px-4 py-2 text-sm text-gray-600" th:text="${producto.vendor?.vendorName}">Vendedor</td>
                <td class="px-4 py-2 text-sm text-gray-800 font-semibold text-center" th:text="'$' + ${#numbers.formatDecimal(producto.price, 1, 'COMMA', 2, 'POINT')}">$99.99</td>
                <td class="px-4 py-2">
                    <div class="flex gap-2 justify-center">
                        <a th:href="@{'/admin/product/' + ${producto.id}}" class="text-blue-600 hover:text-blue-800 p-1">
                            <svg xmlns="http://www.w3.org/2000/svg" width="20" height="20" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round">
                                <path d="M1 12s4-8 11-8 11 8 11 8-4 8-11 8-11-8-11-8z"></path>
                                <circle cx="12" cy="12" r="3"></circle>
                            </svg>
                        </a>
<!--                        <a th:href="@{'/admin/product/delete/' + ${producto.id}}" class="text-red-600 hover:text-red-800 p-1">-->
<!--                            <svg xmlns="http://www.w3.org/2000/svg" width="20" height="20" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"><path d="M3 6h18"/><path d="M19 6v14a2 2 0 0 1-2 2H7a2 2 0 0 1-2-2V6"/><path d="M8 6V4a2 2 0 0 1 2-2h4a2 2 0 0 1 2 2v2"/></svg>-->
<!--                        </a>-->
                    </div>
                </td>
            </tr>
            </tbody>
            <tbody th:if="${productPage == null or productPage.empty}">
            <tr>
                <td colspan="7" class="px-4 py-10 text-center text-gray-500">No se encontraron productos.</td>
            </tr>
            </tbody>
        </table>
    </div>

    <div th:if="${productPage != null and productPage.totalPages > 1}" class="flex items-center justify-between mt-4">
        <span class="text-sm text-gray-700">
            Página <span th:text="${productPage.number + 1}">1</span> de <span th:text="${productPage.totalPages}">10</span>
        </span>
        <div class="flex items-center gap-2">
            <a th:href="@{/admin/products(page=${productPage.number - 1}, query=${param.query})}"
               th:classappend="${productPage.hasPrevious() ? 'bg-white hover:bg-gray-100' : 'bg-gray-200 text-gray-400 cursor-not-allowed'}"
               class="px-3 py-1 border border-gray-300 rounded text-sm font-medium">
                Anterior
            </a>
            <a th:href="@{/admin/products(page=${productPage.number + 1}, query=${param.query})}"
               th:classappend="${productPage.hasNext() ? 'bg-white hover:bg-gray-100' : 'bg-gray-200 text-gray-400 cursor-not-allowed'}"
               class="px-3 py-1 border border-gray-300 rounded text-sm font-medium">
                Siguiente
            </a>
        </div>
    </div>
</div>

</body>
</html>